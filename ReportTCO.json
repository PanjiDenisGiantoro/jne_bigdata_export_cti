{
  "swagger": "2.0",
  "info": {
    "title": "TCO Report API",
    "description": "API untuk menghasilkan laporan TCO dengan memproses data dari database Oracle dan mengunduh laporan dalam format Excel dan zip.",
    "version": "1.0.0"
  },
  "host": "localhost:3005",
  "schemes": [
    "https"
  ],
  "paths": {
    "/getreporttco": {
      "get": {
        "summary": "Generate TCO report",
        "description": "Mendapatkan laporan TCO berdasarkan parameter yang diberikan dan mengembalikan file zip dengan laporan.",
        "parameters": [
          {
            "name": "origin",
            "in": "query",
            "description": "Kode asal lokasi.",
            "required": true,
            "type": "string"
          },
          {
            "name": "destination",
            "in": "query",
            "description": "Kode tujuan lokasi.",
            "required": true,
            "type": "string"
          },
          {
            "name": "froms",
            "in": "query",
            "description": "Tanggal mulai laporan (format: DD-MON-YYYY).",
            "required": true,
            "type": "string"
          },
          {
            "name": "thrus",
            "in": "query",
            "description": "Tanggal akhir laporan (format: DD-MON-YYYY).",
            "required": true,
            "type": "string"
          },
          {
            "name": "service",
            "in": "query",
            "description": "Kode layanan untuk laporan.",
            "required": true,
            "type": "string"
          },
          {
            "name": "user_id",
            "in": "query",
            "description": "ID pengguna untuk laporan.",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "Laporan berhasil dihasilkan dan tersedia untuk diunduh.",
            "schema": {
              "type": "object",
              "properties": {
                "success": {
                  "type": "boolean"
                },
                "message": {
                  "type": "string"
                },
                "jobId": {
                  "type": "string"
                },
                "estimatedDataCount": {
                  "type": "integer"
                },
                "estimatedTimeMinutes": {
                  "type": "string"
                }
              }
            }
          },
          "400": {
            "description": "Parameter yang diperlukan tidak ada."
          },
          "500": {
            "description": "Terjadi kesalahan di server."
          }
        }
      }
    },
    "/jobsdco": {
      "get": {
        "summary": "Get all TCO jobs",
        "description": "Mendapatkan daftar semua pekerjaan TCO yang sedang diproses, beserta statusnya.",
        "responses": {
          "200": {
            "description": "Daftar pekerjaan TCO berhasil diambil.",
            "schema": {
              "type": "object",
              "properties": {
                "success": {
                  "type": "boolean"
                },
                "tableHeaders": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                },
                "tableData": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "ID": { "type": "string" },
                      "UserID": { "type": "string" },
                      "Progress": { "type": "integer" },
                      "Status": { "type": "string" },
                      "ErrorReason": { "type": "string" }
                    }
                  }
                },
                "totalJobs": {
                  "type": "integer"
                },
                "succeededJobs": {
                  "type": "integer"
                },
                "waitingJobs": {
                  "type": "integer"
                },
                "activeJobs": {
                  "type": "integer"
                }
              }
            }
          },
          "500": {
            "description": "Terjadi kesalahan saat mengambil pekerjaan."
          }
        }
      }
    },
    "/jobstco/{id}": {
      "get": {
        "summary": "Get job details by ID",
        "description": "Mendapatkan detail pekerjaan TCO berdasarkan ID pekerjaan.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "ID pekerjaan TCO.",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "Detail pekerjaan berhasil diambil.",
            "schema": {
              "type": "object",
              "properties": {
                "success": {
                  "type": "boolean"
                },
                "id": {
                  "type": "string"
                },
                "Origin": {
                  "type": "string"
                },
                "Destination": {
                  "type": "string"
                },
                "FromDate": {
                  "type": "string"
                },
                "ToDate": {
                  "type": "string"
                },
                "UserID": {
                  "type": "string"
                },
                "service": {
                  "type": "string"
                },
                "Status": {
                  "type": "string"
                },
                "filenamezip": {
                  "type": "string"
                },
                "errorMessage": {
                  "type": "string"
                }
              }
            }
          },
          "404": {
            "description": "Pekerjaan tidak ditemukan."
          },
          "500": {
            "description": "Terjadi kesalahan saat mengambil detail pekerjaan."
          }
        }
      }
    },
    "/downloadtco/{jobId}": {
      "get": {
        "summary": "Download TCO report by job ID",
        "description": "Mengunduh laporan TCO berdasarkan ID pekerjaan.",
        "parameters": [
          {
            "name": "jobId",
            "in": "path",
            "description": "ID pekerjaan TCO untuk mengunduh laporan.",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "Laporan berhasil diunduh.",
            "schema": {
              "type": "file"
            }
          },
          "404": {
            "description": "File tidak ditemukan."
          },
          "500": {
            "description": "Terjadi kesalahan saat mengunduh file."
          }
        }
      }
    }
  }
}
