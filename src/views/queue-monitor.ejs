<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Queue Monitor</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f0f2f5;
            padding: 2rem;
            font-family: 'Inter', 'Segoe UI', sans-serif;
            color: #2c2f36;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1d4ed8;
        }

        h2 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-top: 2rem;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 0.5rem;
        }

        .queue-card {
            background-color: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 16px;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.04);
            transition: all 0.2s ease;
        }

        .queue-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 14px rgba(0, 0, 0, 0.06);
        }

        .queue-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #0f172a;
        }

        .queue-metric {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.35rem;
            font-size: 0.95rem;
        }

        .metric-label {
            color: #6b7280;
        }

        .badge-status {
            font-family: monospace;
            font-size: 0.85rem;
            padding: 0.35em 0.6em;
            border-radius: 0.5rem;
        }

        .last-updated {
            font-size: 0.75rem;
            color: #9ca3af;
            margin-top: 1rem;
        }

        .last-job {
            font-size: 0.875rem;
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid #e5e7eb;
        }

        .last-job .queue-metric {
            font-size: 0.85rem;
            margin-left: 0.5rem;
        }

        .text-faded {
            color: #9ca3af;
        }

        .text-label {
            color: #4b5563;
            font-weight: 500;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1 class="text-center mb-5">üìä Queue Monitor</h1>

        <% for (const [groupName, queues] of Object.entries(groupedQueues)) { %>
            <h2>
                <%= groupName %>
            </h2>
            <div class="row g-4">
                <% queues.forEach((queue)=> { %>
                    <div class="col-md-6 col-lg-4">
                        <div class="card queue-card h-100 p-3">
                            <div class="card-body">
                                <div class="queue-title mb-3">
                                    <%= queue.name %>
                                </div>

                                <div class="queue-metric">
                                    <span class="metric-label">üïì Waiting</span>
                                    <span class="badge bg-warning-subtle text-dark badge-status">
                                        <%= queue.waiting %>
                                    </span>
                                </div>
                                <div class="queue-metric">
                                    <span class="metric-label">‚öôÔ∏è Active</span>
                                    <span class="badge bg-primary-subtle text-dark badge-status">
                                        <%= queue.active %>
                                    </span>
                                </div>
                                <div class="queue-metric">
                                    <span class="metric-label">‚úÖ Completed</span>
                                    <span class="badge bg-success-subtle text-dark badge-status">
                                        <%= queue.completed %>
                                    </span>
                                </div>
                                <div class="queue-metric">
                                    <span class="metric-label">‚ùå Failed</span>
                                    <span class="badge bg-danger-subtle text-dark badge-status">
                                        <%= queue.failed %>
                                    </span>
                                </div>
                                <div class="queue-metric">
                                    <span class="metric-label">‚è≥ Delayed</span>
                                    <span class="badge bg-info-subtle text-dark badge-status">
                                        <%= queue.delayed %>
                                    </span>
                                </div>

                                <div class="last-updated">
                                    üïí Last Updated: <%= queue.lastUpdated || 'N/A' %>
                                </div>

                                <% if (queue.lastJob) { %>
                                    <div class="last-job">
                                        <div class="text-label mb-1">üßæ Last Job:</div>
                                        <div class="queue-metric"><span>ID</span><span>
                                                <%= queue.lastJob.id %>
                                            </span></div>
                                        <div class="queue-metric"><span>Name</span><span>
                                                <%= queue.lastJob.name %>
                                            </span></div>
                                        <div class="queue-metric"><span>Status</span><span>
                                                <%= queue.lastJob.status %>
                                            </span></div>
                                        <% if (queue.lastJob.duration) { %>
                                            <div class="queue-metric"><span>Duration</span><span>
                                                    <%= queue.lastJob.duration %>
                                                </span></div>
                                            <% } %>
                                    </div>
                                    <% } %>
                            </div>
                        </div>
                    </div>
                    <% }); %>
            </div>
            <% } %>
    </div>
</body>

</html>